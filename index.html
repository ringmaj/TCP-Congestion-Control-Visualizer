<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Majok Francis Ring</title>
    <!-- Bootstrap -->
    <link href='https://fonts.googleapis.com/css?family=Lato:400,300italic' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Condensed" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Abel" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet">
    <link href="http://s3.amazonaws.com/codecademy-content/courses/ltp/css/shift.css" rel="stylesheet">
    <link rel="stylesheet" href="http://s3.amazonaws.com/codecademy-content/courses/ltp/css/bootstrap.css">
    <link rel="stylesheet" href="main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lato:300" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:100" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.0.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery.typeit/4.4.0/typeit.min.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>

</head>

<body>


    <!--------------------------- NAV BAR-------------------------------------------------------------->
    <nav class="navbar navbar-default navbar-fixed-top" id="navB">
        <div class="container" id="navc">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>
                <a class="navbar-brand" href="#"></a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">

                    <li class="active"><a href="#top">Home</a></li>
                    <li id="aboutButton"><a href="#aboutMe">AIMD</a></li>
                    <li><a href="#experience-container">Slow Start</a></li>

                    <li><a href="#pdf-container">Tutorial</a></li>

                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li id="timeline-tab"><a href="#timeline-container">LinkedIn</a></li>
                    <li><a href="#empty">GitHub <span class="sr-only">(current)</span></a></li>
                </ul>
            </div>
            <!--/.nav-collapse -->
        </div>
    </nav>
    <!------------------------------------------------------------------------------------------------->



    <!-- Packet List-->
    <div id="packetSelector" class="noselect">

        <!------------------------------------------------------------------------------------------------->
        <!-- Select how many packets are being sent-->
        <div class="conatainer numPacketsSelector">

            <!--            Number of Packets sent-->
            <div id="numPacketsField" class="generalInputField">Number of packets sent <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
            </div>
            <form id="numPacketSentForm" class="inputValue" onsubmit="initPackets(); return false">
                <input id="numPacketsSentField" class="inputBorder numberField" type="number" name="numberOfPacketsSent" placeholder="?">
            </form>


            <!--            packet size-->
            <div id="numPacketsField" class="generalInputField">Packet size (Bytes) <span class="glyphicon glyphicon-sort" aria-hidden="true">   </span>
            </div>
            <form id="packageSizeForm" class="inputValue" onsubmit="initPackets(); return false">
                <input id="packageSizeField" class="inputBorder numberField" type="number" name="packageSize" placeholder="?">
            </form>

            <!--            RTT time-->
            <div id="numPacketsField" class="generalInputField">RTT Time (ms) <span class="glyphicon glyphicon-time" aria-hidden="true"></span>
            </div>
            <form id="rttForm" class="inputValue" onsubmit="initPackets(); return false">
                <input id="rttField" class="inputBorder numberField" type="number" name="rtt" placeholder="?">
            </form>


            <button type="button" id="startButton" onclick="initPackets(); return false">Start Program</button>




        </div>
        <!------------------------------------------------------------------------------------------------->
        <ul id="packetList">
            <li id="packetsSent">Packets sent <span class="	glyphicon glyphicon-send	Try it
" aria-hidden="true"></span></li>
            <li>1</li>
            <li>2</li>
            <li>3</li>
            <li>4</li>
        </ul>
        <!------------------------------------------------------------------------------------------------->
        <ul id="packetDroppedList">
            <li id="packetsDropped">Packets dropped <span class="glyphicon">&#xe014;</span></li>
        </ul>
        <!------------------------------------------------------------------------------------------------->
        <canvas id="myChart" width="1500" height="450"></canvas>
        <!------------------------------------------------------------------------------------------------->


        <script>
            //------------------------ Creating our chart ---------------------------------------------------------------

            var ctx = document.getElementById("myChart").getContext('2d');
            var rttNum = [1];
            for (var i = 2; i < 10; i++) {
                rttNum.push(i);
            }
            var myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: rttNum,
                    datasets: [
                        //                         {fill: 'origin'},
                        {
                            data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                            label: "AIMD",
                            borderColor: "#3e95cd",
                            fill: false
                        }, {
                            data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                            label: "Slow Start",
                            borderColor: "#8e5ea2",
                            fill: false
                        }
                    ]
                },
                options: {

                    title: {
                        display: true,
                        text: 'TCP Congestion Control Methods'
                    },
                    scales: {
                        xAxes: [{
                            scaleLabel: {
                                display: true,
                                labelString: 'RTT',
                                fontColor: '#555555',
                                fontStyle: "bold"
                            }
                        }],
                        yAxes: [{
                            scaleLabel: {
                                display: true,
                                labelString: 'Congestion Window',
                                fontColor: '#555555',
                                fontStyle: "bold"
                            }
                        }]
                    },
                    elements: {
                        line: {
                            tension: 0
                        }
                    }
                }
            });

            //-----------------------------------------------------------------------------------------------------------


            function addData(chart, label, data) {
                chart.data.labels.push(label);
                chart.data.datasets.forEach((dataset) => {
                    dataset.data.push(data);
                });
                chart.update();
            }

            function removeData(chart) {
                chart.data.labels = [];
                chart.data.datasets[0] = [];
                chart.data.datasets[1] = [];

                chart.update();
                console.log("removed data?");
            }


            // Global variables 
            var droppedSize = document.getElementById("packetDroppedList").getElementsByTagName("li").length - 1;
            var packetsDroppedArray = new Array(droppedSize);

            // Function to initialize a number of packets sent
            function initPackets() {

                packetsDroppedArray = [];
                var numPackets = Number(document.forms[0].numberOfPacketsSent.value);
                var size = document.getElementById("packetList").getElementsByTagName("li").length;
                var myNode = document.getElementById("packetDroppedList");

                while (document.getElementById("packetDroppedList").getElementsByTagName("li").length > 1) {
                    myNode.removeChild(myNode.lastChild);
                }

                myNode = document.getElementById("packetList");
                while (document.getElementById("packetList").getElementsByTagName("li").length > 1) {
                    myNode.removeChild(myNode.lastChild);
                }

                // Add the number of packets selected
                for (var i = 0; i < numPackets; i++) {
                    var node = document.createElement("li");
                    var textnode = document.createTextNode(i + 1);
                    node.appendChild(textnode);
                    document.getElementById("packetList").appendChild(node);
                }

                // Run AIMD --------------------------------------------------------
                var aimdData = AIMD(packetsDroppedArray);
                var aimdLabel = new Array();

                for (var i = 1; i <= aimdData.length; i++) {
                    aimdLabel.push(i);
                }
                myChart.data.datasets[0].data = aimdData;
                myChart.data.labels = aimdLabel;
                myChart.update();

                // Run Slow Start --------------------------------------------------
                var slowStartData = slowStart(packetsDroppedArray);
                var slowStartLabel = new Array();

                for (var i = 1; i <= slowStartData.length; i++) {
                    slowStartLabel.push(i);
                }
                myChart.data.datasets[1].data = slowStartData;
                myChart.data.labels = slowStartLabel;
                myChart.update();
            }

            function AIMD(packetsDroppedArray) {
                var congestionWindow = 1;
                var RTT = 1;
                var lastPacketSent = 1;
                var totalToSend = Number(document.forms[0].numberOfPacketsSent.value);
                var currentlySendArray = new Array();
                var packetsDroppedArr = packetsDroppedArray.slice();
                var outputData = new Array();
                var maxCWindow = 1;

                // Check if packet is dropped
                function isDropped(packetNum) {
                    var dropped = false;

                    for (var i = 0; i < packetsDroppedArr.length; i++) {
                        if (packetsDroppedArr[i] == packetNum) {
                            dropped = true;
                            packetsDroppedArr.splice(i, 1);
                            console.log("Removed: " + packetsDroppedArr[i]);
                        }
                    }
                    return dropped;
                }

                // Reset outputlist to empty
                var myNode = document.getElementById("aimdSendOutPutList");
                while (myNode.firstChild) {
                    myNode.removeChild(myNode.firstChild);
                }


                // While there are still packets left to send, send packets
                while (lastPacketSent <= totalToSend) {
                    var sendString = "Currently Sending: ";
                    var saveLastPacketSent = lastPacketSent;
                    console.log("RTT: " + RTT);
                    console.log("Congestion Window: " + congestionWindow + "\n");
                    currentlySendArray = [];
                    var dropped = false;

                    if (congestionWindow > maxCWindow)
                        maxCWindow = congestionWindow;

                    var ul = document.createElement("ul");
                    ul.setAttribute("id", "outputPacketList");
                    ul.setAttribute("class", "outPutListDiv");


                    // Add current RTT ----------------------------------------------------------------------------------
                    var textnode = document.createTextNode("RTT: " + RTT);
                    var node = document.createElement("li");
                    node.setAttribute("id", "packetsSent");
                    node.appendChild(textnode);
                    ul.appendChild(node);

                    // Add window ---------------------------------------------------------------------------------------
                    textnode = document.createTextNode("cwnd: " + congestionWindow);
                    node = document.createElement("li");
                    node.setAttribute("id", "cwnd");
                    node.appendChild(textnode);
                    node.style.backgroundColor = "#b9d4ff";
                    node.style.color = "#505050";
                    ul.appendChild(node);

                    // Add Arrow ----------------------------------------------------------------------------------------

                    textnode = document.createTextNode("--------->");
                    node = document.createElement("li");
                    node.appendChild(textnode);
                    node.style.backgroundColor = "#ffffff";
                    node.style.color = "#505050";
                    ul.appendChild(node);

                    for (var i = 0; i < congestionWindow; i++) {
                        currentlySendArray[i] = lastPacketSent;


                        if (i > 0 && (currentlySendArray[i] == currentlySendArray[i - 1])) {
                            textnode = document.createTextNode(currentlySendArray[i] + 1);
                            currentlySendArray[i]++;
                            console.log("REPEAT!");
                        } else {
                            if (currentlySendArray[i] < currentlySendArray[i - 1])
                                currentlySendArray[i] = currentlySendArray[i - 1] + 1;
                            textnode = document.createTextNode(currentlySendArray[i]);
                        }

                        node = document.createElement("li");
                        node.appendChild(textnode);

                        if (dropped == false) {
                            dropped = isDropped(currentlySendArray[i]);
                            if (dropped == false) {
                                lastPacketSent++;
                            } else {
                                node.style.backgroundColor = "#ff3b3b";
                                node.style.color = "white";
                            }
                        }

                        if (currentlySendArray[i] <= totalToSend)
                            ul.appendChild(node);


                        if (currentlySendArray[i] <= totalToSend)
                            sendString += (currentlySendArray[i] + ", ");
                    }

                    myNode.appendChild(ul);

                    console.log(sendString + "\n");
                    console.log("\n");


                    // If a packet is successfully sent, increase the congestion window by 1, else decrease the congestion window by half
                    if (dropped == false) {
                        outputData.push(congestionWindow);
                        congestionWindow++;

                    } else {
                        outputData.push(congestionWindow);
                        congestionWindow = Math.floor(congestionWindow / 2);

                    }
                    RTT++;
                }


                // Update Analysis Data Section -----------------------------------------------------------------------------------------------------


                // Update packages sent -------------------------------------------------------
                myNode = document.getElementById("aimdPackSent");
                myNode.innerHTML = document.forms[0].numberOfPacketsSent.value;

                // Update packages dropped -------------------------------------------------------
                myNode = document.getElementById("aimdPackDropped");
                myNode.innerHTML = packetsDroppedArray.length;

                // Update packet size -------------------------------------------------------
                myNode = document.getElementById("aimdPackSize");
                var units = " B"
                var packetSize = Number(document.forms[1].packageSize.value);
                if (packetSize < 1000) {
                    units = " B";
                } else if (packetSize < 1000000) {
                    packetSize = packetSize / 1000;
                    units = " KB";
                } else if (packetSize < 1000000000) {
                    packetSize = packetSize / 1000000;
                    units = " MB";
                } else if (packetSize < 1000000000000) {
                    packetSize = packetSize / 1000000000;
                    units = " GB";
                }
                myNode.innerHTML = packetSize + units;


                // Update packages max congestion window -------------------------------------------------------
                myNode = document.getElementById("aimdMaxCWindow");
                myNode.innerHTML = maxCWindow;

                // Update packages max congestion RTT -------------------------------------------------------
                myNode = document.getElementById("aimdMaxRTT");
                myNode.innerHTML = RTT - 1;

                // Update total transmission time -------------------------------------------------------
                var transmissionTimeUnits = " ms";
                var rttTime = Number(document.forms[2].rtt.value);
                var transmissionTime = rttTime * (RTT - 1);
                myNode = document.getElementById("aimdTransmissionTime");
                myNode.innerHTML = "( " + (RTT - 1) + " RTT )";
                myNode = document.getElementById("aimdRTTcalc");
                myNode.innerHTML = document.forms[2].rtt.value + " ms";
                myNode = document.getElementById("aimdTotalTransmissionTime");
                if (transmissionTime == 1000) {
                    transmissionTimeUnits = " second";
                    transmissionTime = transmissionTime / 1000;
                }
                if (transmissionTime > 1000) {
                    transmissionTimeUnits = " seconds";
                    transmissionTime = transmissionTime / 1000;
                }
                myNode.innerHTML = " = " + transmissionTime + transmissionTimeUnits;


                // Update packages max congestion RTT -------------------------------------------------------
                var bytes = Number(document.forms[1].packageSize.value);
                var numberOfPacketsSent = Number(document.forms[0].numberOfPacketsSent.value);
                var bits = numberOfPacketsSent * bytes * 8;
                var throughput;
                units = " b/s"
                myNode = document.getElementById("aimdThroughput");
                transmissionTime = rttTime * (RTT - 1);
                transmissionTime = transmissionTime / 1000;
                throughput = bits / transmissionTime;

                if (throughput < 1000) {
                    units = " b/s";
                } else if (throughput < 1000000) {
                    throughput = throughput / 1000;
                    units = " kb/s";
                } else if (throughput < 1000000000) {
                    throughput = throughput / 1000000;
                    units = " mb/s";
                } else if (throughput < 1000000000000) {
                    throughput = throughput / 1000000000;
                    units = " gb/s";
                }

                myNode.innerHTML = bits + " bits / " + transmissionTime + " seconds = " + (throughput).toFixed(2) + units;

                // Return data to be entered into our chart
                return outputData;
            }









            //-----------------------------------------------------------------------------------------------------------------------------------------------------------------------








            function slowStart(packetsDroppedArray) {
                var congestionWindow = 1;
                var RTT = 1;
                var lastPacketSent = 1;
                var totalToSend = Number(document.forms[0].numberOfPacketsSent.value);
                var currentlySendArray = new Array();
                var packetsDroppedArr = packetsDroppedArray.slice();
                var outputData = new Array();
                var maxCWindow = 1;
                var state = "INITIAL_INCREASE";
                var congestionThreshold = 0;

                // Check if packet is dropped
                function isDropped(packetNum) {
                    var dropped = false;

                    for (var i = 0; i < packetsDroppedArr.length; i++) {
                        if (packetsDroppedArr[i] == packetNum) {
                            dropped = true;
                            packetsDroppedArr.splice(i, 1);
                            console.log("Removed: " + packetsDroppedArr[i]);
                        }
                    }
                    return dropped;
                }

                // Reset outputlist to empty
                var myNode = document.getElementById("slowStartSendOutPutList");
                while (myNode.firstChild) {
                    myNode.removeChild(myNode.firstChild);
                }


                // While there are still packets left to send, send packets
                while (lastPacketSent <= totalToSend) {
                    var sendString = "Currently Sending: ";
                    var saveLastPacketSent = lastPacketSent;
                    console.log("RTT: " + RTT);
                    console.log("Congestion Window: " + congestionWindow + "\n");
                    currentlySendArray = [];
                    var dropped = false;

                    if (congestionWindow > maxCWindow)
                        maxCWindow = congestionWindow;

                    var ul = document.createElement("ul");
                    ul.setAttribute("id", "outputPacketList");
                    ul.setAttribute("class", "outPutListDiv");


                    // Add current RTT ----------------------------------------------------------------------------------
                    var textnode = document.createTextNode("RTT: " + RTT);
                    var node = document.createElement("li");
                    node.setAttribute("id", "packetsSent");
                    node.appendChild(textnode);
                    ul.appendChild(node);

                    // Add window ---------------------------------------------------------------------------------------
                    textnode = document.createTextNode("cwnd: " + congestionWindow);
                    node = document.createElement("li");
                    node.setAttribute("id", "cwnd");
                    node.appendChild(textnode);
                    node.style.backgroundColor = "#b9d4ff";
                    node.style.color = "#505050";
                    ul.appendChild(node);

                    // Add congestion threshold -------------------------------------------------------------------------
                    textnode = document.createTextNode("Threshold: " + congestionThreshold);
                    node = document.createElement("li");
                    node.setAttribute("id", "cwnd");
                    node.appendChild(textnode);
                    node.style.backgroundColor = "#b9d4ff";
                    node.style.color = "#505050";
                    if (state == "EXPONENTIAL_INCREASE" || state == "INITIAL_INCREASE")
                        ul.appendChild(node);

                    // Add Arrow ----------------------------------------------------------------------------------------

                    textnode = document.createTextNode("--------->");
                    node = document.createElement("li");
                    node.appendChild(textnode);
                    node.style.backgroundColor = "#ffffff";
                    node.style.color = "#505050";
                    ul.appendChild(node);

                    for (var i = 0; i < congestionWindow; i++) {




                        currentlySendArray[i] = lastPacketSent;


                        if (i > 0 && (currentlySendArray[i] == currentlySendArray[i - 1])) {
                            textnode = document.createTextNode(currentlySendArray[i] + 1);
                            currentlySendArray[i]++;
                            console.log("REPEAT!");
                        } else {
                            if (currentlySendArray[i] < currentlySendArray[i - 1])
                                currentlySendArray[i] = currentlySendArray[i - 1] + 1;
                            textnode = document.createTextNode(currentlySendArray[i]);
                        }

                        node = document.createElement("li");
                        node.appendChild(textnode);

                        if (dropped == false) {
                            dropped = isDropped(currentlySendArray[i]);
                            if (dropped == false) {
                                lastPacketSent++;
                            } else {
                                node.style.backgroundColor = "#ff3b3b";
                                node.style.color = "white";
                            }
                        }

                        if (currentlySendArray[i] <= totalToSend)
                            ul.appendChild(node);


                        if (currentlySendArray[i] <= totalToSend)
                            sendString += (currentlySendArray[i] + ", ");

                        
                        
                        
                        
                        
                        if (state == "EXPONENTIAL_INCREASE") {

                            if (congestionWindow >= congestionThreshold) {
                                state = "ADDITIVE_INCREASE";
//                                break;
                            }

                        }
                        
                        
                        
                    }

                    myNode.appendChild(ul);

                    console.log(sendString + "\n");
                    console.log("\n");


                    // If a packet is successfully sent, increase the congestion window by a multiple of 2, else decrease the congestion to 1
                    if (dropped == false) {
                        outputData.push(congestionWindow);

                        if (state == "INITIAL_INCREASE") {
                            congestionWindow = congestionWindow * 2;
                        } else if (state == "EXPONENTIAL_INCREASE") {
                            
                            if(congestionWindow * 2 <= congestionThreshold)
                            congestionWindow = congestionWindow * 2;
                            else {
                                congestionWindow = congestionThreshold;
                            }
                        } else if (state == "ADDITIVE_INCREASE") {
                            congestionWindow++;
                        }


                    } else {
                        outputData.push(congestionWindow);

                        if (state == "INITIAL_INCREASE") {
                            state = "EXPONENTIAL_INCREASE";
                            congestionThreshold = congestionWindow / 2;
                            congestionWindow = 1;
                        } else if (state == "ADDITIVE_INCREASE") {
                            state = "EXPONENTIAL_INCREASE";
                            congestionThreshold = Math.floor(congestionWindow / 2);
                            congestionWindow = 1;
                        }

                    }
                    RTT++;
                }


                // Update Analysis Data Section -----------------------------------------------------------------------------------------------------


                // Update packages sent -------------------------------------------------------
                myNode = document.getElementById("slowStartPackSent");
                myNode.innerHTML = document.forms[0].numberOfPacketsSent.value;

                // Update packages dropped -------------------------------------------------------
                myNode = document.getElementById("slowStartPackDropped");
                myNode.innerHTML = packetsDroppedArray.length;

                // Update packet size -------------------------------------------------------
                myNode = document.getElementById("slowStartPackSize");
                var units = " B"
                var packetSize = Number(document.forms[1].packageSize.value);
                if (packetSize < 1000) {
                    units = " B";
                } else if (packetSize < 1000000) {
                    packetSize = packetSize / 1000;
                    units = " KB";
                } else if (packetSize < 1000000000) {
                    packetSize = packetSize / 1000000;
                    units = " MB";
                } else if (packetSize < 1000000000000) {
                    packetSize = packetSize / 1000000000;
                    units = " GB";
                }
                myNode.innerHTML = packetSize + units;


                // Update packages max congestion window -------------------------------------------------------
                myNode = document.getElementById("slowStartMaxCWindow");
                myNode.innerHTML = maxCWindow;

                // Update packages max congestion RTT -------------------------------------------------------
                myNode = document.getElementById("slowStartMaxRTT");
                myNode.innerHTML = RTT - 1;

                // Update total transmission time -------------------------------------------------------
                var transmissionTimeUnits = " ms";
                var rttTime = Number(document.forms[2].rtt.value);
                var transmissionTime = rttTime * (RTT - 1);
                myNode = document.getElementById("slowStartTransmissionTime");
                myNode.innerHTML = "( " + (RTT - 1) + " RTT )";
                myNode = document.getElementById("slowStartRTTcalc");
                myNode.innerHTML = document.forms[2].rtt.value + " ms";
                myNode = document.getElementById("slowStartTotalTransmissionTime");
                if (transmissionTime == 1000) {
                    transmissionTimeUnits = " second";
                    transmissionTime = transmissionTime / 1000;
                }
                if (transmissionTime > 1000) {
                    transmissionTimeUnits = " seconds";
                    transmissionTime = transmissionTime / 1000;
                }
                myNode.innerHTML = " = " + transmissionTime + transmissionTimeUnits;


                // Update packages max congestion RTT -------------------------------------------------------
                var bytes = Number(document.forms[1].packageSize.value);
                var numberOfPacketsSent = Number(document.forms[0].numberOfPacketsSent.value);
                var bits = numberOfPacketsSent * bytes * 8;
                var throughput;
                units = " b/s"
                myNode = document.getElementById("slowStartThroughput");
                transmissionTime = rttTime * (RTT - 1);
                transmissionTime = transmissionTime / 1000;
                throughput = bits / transmissionTime;

                if (throughput < 1000) {
                    units = " b/s";
                } else if (throughput < 1000000) {
                    throughput = throughput / 1000;
                    units = " kb/s";
                } else if (throughput < 1000000000) {
                    throughput = throughput / 1000000;
                    units = " mb/s";
                } else if (throughput < 1000000000000) {
                    throughput = throughput / 1000000000;
                    units = " gb/s";
                }

                myNode.innerHTML = bits + " bits / " + transmissionTime + " seconds = " + (throughput).toFixed(2) + units;

                // Return data to be entered into our chart
                return outputData;
            }


            // Click function for packet drops ----------------------------------------------------------------------------------------
            document.getElementById("packetList").addEventListener("click", function(e) {
                var size = document.getElementById("packetDroppedList").getElementsByTagName("li").length;
                var alreadyDropped = false;

                // e.target is our targetted element.
                if (e.target && e.target.nodeName == "LI") {
                    e.target.style.backgroundColor = "#ff3b3b";
                    e.target.style.color = "white";

                    for (var i = 0; i < packetsDroppedArray.length; i++) {
                        if (packetsDroppedArray[i] == Number(e.target.innerHTML)) {
                            alreadyDropped = true;
                        }
                    }

                    if (alreadyDropped == false) {
                        // push to our array of dropped packets
                        packetsDroppedArray.push(Number(e.target.innerHTML));
                    } else {
                        var index = packetsDroppedArray.indexOf(Number(e.target.innerHTML));
                        packetsDroppedArray.splice(index, 1);
                        e.target.style.backgroundColor = "#e2e2e2";
                        e.target.style.color = "black";
                    }

                    // sort our dropped packets
                    packetsDroppedArray.sort(function(a, b) {
                        return a - b
                    });

                    // Clear our packetlist by removing all child nodes
                    var myNode = document.getElementById("packetDroppedList");
                    while (document.getElementById("packetDroppedList").getElementsByTagName("li").length > 1) {
                        myNode.removeChild(myNode.lastChild);
                    }
                    // Add to packets dropped list 
                    for (var i = 0; i < packetsDroppedArray.length; i++) {
                        var node = document.createElement("li");
                        var textnode = document.createTextNode(packetsDroppedArray[i]);
                        node.appendChild(textnode);
                        document.getElementById("packetDroppedList").appendChild(node);
                    }

                    // Run AIMD ---------------------------------------------------------------------------------------------------
                    var aimdData = AIMD(packetsDroppedArray);
                    var aimdLabel = new Array();

                    for (var i = 1; i <= aimdData.length; i++) {
                        aimdLabel.push(i);
                    }
                    myChart.data.datasets[0].data = aimdData;
                    myChart.data.labels = aimdLabel;
                    myChart.update();

                    // Run Slow Start ---------------------------------------------------------------------------------------------

                    var slowStartData = slowStart(packetsDroppedArray);
                    var slowStartLabel = new Array();

                    for (var i = 1; i <= slowStartData.length; i++) {
                        slowStartLabel.push(i);
                    }
                    myChart.data.datasets[1].data = slowStartData;
                    myChart.data.labels = slowStartLabel;
                    myChart.update();


                }
            });
        </script>

    </div>

    <div id="analysisSection">

        <!--- Analysis Section for AIMD --------------------------------------------------------------------------------------------------------->
        <div id="aimdAnalysis">
            <div class="analysisTitle">
                <p>AIMD Analysis</p>
                <!--- Packets Sent and Dropped ---------------------------------------------------------------------------------------------------------->
                <div class="SentDroppedDiv">
                    <p>Packets Sent:
                        <p id="aimdPackSent" class="analysisPackInfo analysisAnswer">46</p>
                        <p>Packets Dropped:
                            <p id="aimdPackDropped" class="analysisPackInfo noBorder analysisAnswer">5</p>
                </div>
                <!--- Packet Size ----------------------------------------------------------------------------------------------------------------------->
                <div class="SentDroppedDiv">
                    <p>Packet Size:
                        <p id="aimdPackSize" class="analysisPackInfo noBorder analysisAnswer">1500 KB</p>
                </div>
                <!--- Largest Congestion Window --------------------------------------------------------------------------------------------------------->
                <div class="SentDroppedDiv">
                    <p>Largest Congestion Window:
                        <p id="aimdMaxCWindow" class="analysisPackInfo noBorder analysisAnswer">16</p>
                </div>
                <!--- Max RTT and Total Transmission Time ----------------------------------------------------------------------------------------------->
                <div class="SentDroppedDiv">
                    <p>Max RTT #:
                        <p id="aimdMaxRTT" class="analysisPackInfo analysisAnswer">46</p>
                        <p>Total Transmission Time:
                            <p id="aimdTransmissionTime" class="analysisPackInfo noBorder analysisAnswer"> ( 19 RTT ) x</p>
                            <div class="fraction">
                                <span class="fup" id="aimdRTTcalc">100 ms</span>
                                <span class="bar">/</span>
                                <span class="fdn">RTT</span>
                            </div>
                            <p id="aimdTotalTransmissionTime" class="analysisPackInfo noBorder analysisAnswer"> = 51 ms</p>
                </div>
                <!--- Throughput ---------------------------------------------------------------------------------------------------------------------->
                <div class="SentDroppedDiv">
                    <p>Throughput:
                        <p id="aimdThroughput" class="analysisPackInfo noBorder analysisAnswer">16 bps</p>
                </div>
                <!--- Sending Output List ---------------------------------------------------------------------------------------------------------->
                <div class="SentDroppedDiv" id="outputList">
                    <p>Sending Output:</p>
                    <div id="aimdSendOutPutList">
                    </div>
                </div>
            </div>
        </div>




        <!--- Analysis Section for Slow Start ----------------------------------------------------------------------------------------------------------->
        <div id="aimdAnalysis">
            <div class="analysisTitle">
                <p>Slow Start Analysis</p>
                <!--- Packets Sent and Dropped ---------------------------------------------------------------------------------------------------------->
                <div class="SentDroppedDiv">
                    <p>Packets Sent:
                        <p id="slowStartPackSent" class="analysisPackInfo analysisAnswer">46</p>
                        <p>Packets Dropped:
                            <p id="slowStartPackDropped" class="analysisPackInfo noBorder analysisAnswer">5</p>
                </div>
                <!--- Packet Size ----------------------------------------------------------------------------------------------------------------------->
                <div class="SentDroppedDiv">
                    <p>Packet Size:
                        <p id="slowStartPackSize" class="analysisPackInfo noBorder analysisAnswer">1500 KB</p>
                </div>
                <!--- Largest Congestion Window --------------------------------------------------------------------------------------------------------->
                <div class="SentDroppedDiv">
                    <p>Largest Congestion Window:
                        <p id="slowStartMaxCWindow" class="analysisPackInfo noBorder analysisAnswer">16</p>
                </div>
                <!--- Max RTT and Total Transmission Time ----------------------------------------------------------------------------------------------->
                <div class="SentDroppedDiv">
                    <p>Max RTT #:
                        <p id="slowStartMaxRTT" class="analysisPackInfo analysisAnswer">46</p>
                        <p>Total Transmission Time:
                            <p id="slowStartTransmissionTime" class="analysisPackInfo noBorder analysisAnswer"> ( 19 RTT ) x</p>
                            <div class="fraction">
                                <span class="fup" id="slowStartRTTcalc">100 ms</span>
                                <span class="bar">/</span>
                                <span class="fdn">RTT</span>
                            </div>
                            <p id="slowStartTotalTransmissionTime" class="analysisPackInfo noBorder analysisAnswer"> = 51 ms</p>
                </div>
                <!--- Throughput ---------------------------------------------------------------------------------------------------------------------->
                <div class="SentDroppedDiv">
                    <p>Throughput:
                        <p id="slowStartThroughput" class="analysisPackInfo noBorder analysisAnswer">16 bps</p>
                </div>
                <!--- Sending Output List ---------------------------------------------------------------------------------------------------------->
                <div class="SentDroppedDiv" id="outputList">
                    <p>Sending Output:</p>
                    <div id="slowStartSendOutPutList">
                    </div>
                </div>
            </div>
        </div>










    </div>


    <!------------------------------------------------------------------------------------------------->

</body>

</html>
